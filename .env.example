# =============================================================================
# SuperX Orchestrator Environment Configuration
# =============================================================================
# Copy this file to .env and customize for your environment.
# Most settings have sensible defaults for development.
# =============================================================================

# -----------------------------------------------------------------------------
# Persistence Mode
# -----------------------------------------------------------------------------
# Options: "memory" (default) or "postgres"
# - memory: Fast, no external dependencies, data lost on restart
# - postgres: Production-ready, persistent storage
SUPERX_PERSISTENCE=memory

# -----------------------------------------------------------------------------
# Server Configuration
# -----------------------------------------------------------------------------
SUPERX_HOST=localhost
SUPERX_PORT=4000
# Generate with: mix phx.gen.secret
SECRET_KEY_BASE=your-secret-key-base-generate-with-mix-phx-gen-secret

# -----------------------------------------------------------------------------
# Erlang Distribution (recommended for clustering/telemetry)
# -----------------------------------------------------------------------------
# name vs sname: use sname unless you have FQDN
RELEASE_DISTRIBUTION=sname
# Short node name (used when sname is set)
RELEASE_NODE=orchestrator
# Strong cookie for distributed Erlang (set a secure value in production)
RELEASE_COOKIE=please-change-this-in-production
# Pin Erlang distribution ports for firewall rules
ERL_AFLAGS="-kernel inet_dist_listen_min 9000 inet_dist_listen_max 9000"

# -----------------------------------------------------------------------------
# PostgreSQL Configuration (only needed if SUPERX_PERSISTENCE=postgres)
# -----------------------------------------------------------------------------
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=postgres
DB_NAME=superx_dev
DB_POOL_SIZE=10

# -----------------------------------------------------------------------------
# Agent Configuration
# -----------------------------------------------------------------------------
# Absolute path to agents YAML configuration file
# If not set, no agents are loaded from YAML (use API or env vars instead)
# AGENTS_FILE=/app/config/agents.yml

# Default agent URL (legacy single-agent support)
# A2A_REMOTE_URL=http://localhost:8001/rpc
# A2A_REMOTE_BEARER=your-bearer-token

# -----------------------------------------------------------------------------
# HTTP Client Configuration
# -----------------------------------------------------------------------------
# Default timeout for HTTP requests to agents (ms)
HTTP_TIMEOUT=30000
# Timeout for fetching agent cards (ms)
HTTP_CARD_TIMEOUT=5000
# Connection pool size (total connections across all pools)
HTTP_POOL_SIZE=50

# -----------------------------------------------------------------------------
# Push Notification Configuration
# -----------------------------------------------------------------------------
# Maximum delivery attempts for webhook notifications
PUSH_MAX_ATTEMPTS=3
# Base delay for exponential backoff (ms)
PUSH_RETRY_BASE_MS=200
# JWT token time-to-live for signed webhooks (seconds)
PUSH_JWT_TTL_SECONDS=300
# Allowed clock skew for JWT validation (seconds)
PUSH_JWT_SKEW_SECONDS=120

# -----------------------------------------------------------------------------
# Agent Worker Configuration (Circuit Breaker)
# -----------------------------------------------------------------------------
# Maximum concurrent requests per agent
AGENT_MAX_IN_FLIGHT=10
# Failures before circuit breaker opens
AGENT_FAILURE_THRESHOLD=5
# Time window for counting failures (ms)
AGENT_FAILURE_WINDOW_MS=30000
# Cooldown period after circuit opens (ms)
AGENT_COOLDOWN_MS=30000
# Default timeout for agent calls (ms)
AGENT_CALL_TIMEOUT=15000

# -----------------------------------------------------------------------------
# Cluster Configuration (for distributed deployments)
# -----------------------------------------------------------------------------
# Cluster strategy: gossip, dns, kubernetes (leave empty for single-node)
# CLUSTER_STRATEGY=
# For gossip strategy:
# CLUSTER_PORT=45892
# For DNS strategy:
# CLUSTER_DNS_QUERY=orchestrator.local
# CLUSTER_NODE_BASENAME=orchestrator
# CLUSTER_DNS_POLLING_INTERVAL=5000
# For Kubernetes strategy:
# CLUSTER_K8S_SELECTOR=app=orchestrator
# CLUSTER_K8S_NAMESPACE=default

# RPC timeout for cluster communication (ms)
CLUSTER_RPC_TIMEOUT=5000
# Timeout for in-flight load queries (ms)
CLUSTER_IN_FLIGHT_TIMEOUT=1000
